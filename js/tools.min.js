config.tools={addGuide:{id:"addGuide",isDefault:!1,isActive:!1,launcher:"menu_view",horizontal:{mousedown:function(e){e.scope.data.tools.addGuide.isActive="horizontal",console.log("hor md")},mouseup:function(e){console.log("hor mu");var t=e.scope.data;t.tools.addGuide.isActive=!1;t.tree.getSelectedElement(t.tree.root.children)}},vertical:{mousedown:function(e){e.scope.data.tools.addGuide.isActive="vertical",console.log("ver md")},mouseup:function(e){e.scope.data.tools.addGuide.isActive=!1,console.log("ver mu")}}},drawArea:{cursor:"crosshair",id:"drawArea",isDefault:!1,isActive:!1,launcher:"toolbar",label:"Draw Area",iconClass:"ci select",isMoving:!1,optionsTemplate:'<div id="drawAreaOptions" class="options-panel form-inline"><div class="form-group"><label for="drawAreaTop">Top</label><input class="form-control" type="text" aria-describedby="drawAreaTop" ng-model="data.tools.drawArea.config.areaStyle.top" x-key-increment /></div><div class="form-group"><label for="drawAreaHeight">Left</label><input class="form-control" type="text" aria-describedby="drawAreaLeft" ng-model="data.tools.drawArea.config.areaStyle.left" x-key-increment /></div><div class="form-group"><label for="drawAreaWidth">Width</label><input class="form-control" type="text" aria-describedby="drawAreaWidth" ng-model="data.tools.drawArea.config.areaStyle.width" x-key-increment /></div><div class="form-group"><label for="drawAreaHeight">Height</label><input class="form-control" type="text" aria-describedby="drawAreaHeight" ng-model="data.tools.drawArea.config.areaStyle.height" x-key-increment /></div></div>',element:null,baseConfig:{leftPx:0,topPx:0,areaClass:"draw-area",areaStyle:{left:"0",top:"0",width:"0",height:"0"}},config:null,init:function(e,t){t.data.tools.drawArea.config=$.extend({},config.tools.drawArea.baseConfig);var a=$("#canvas"),o='<div id="drawAreaBox" ng-class="data.tools.drawArea.config.areaClass" ng-style="data.tools.drawArea.config.areaStyle"></div>',l=e(o)(t),r=$("#toolOptions"),n=e(t.data.tools.drawArea.optionsTemplate)(t);a.append(l),r.append(n),t.data.tools.drawArea.element=l,t.data.tools.drawArea.optionsMenu=n},destroy:function(e){e.data.tools.drawArea.config=$.extend({},config.tools.drawArea.baseConfig);var t=e.data.tools.drawArea;t.element&&(t.element.remove(),t.optionsMenu.remove())},setUndo:function(){},mousedown:function(e){e.scope.$apply(function(){var t=e.scope.data,a=t.tools.drawArea.config,o=e.event,l=$("#canvas");if(o.target==l[0])a.initPos={lPx:o.offsetX,tPx:o.offsetY},a.areaStyle={left:o.offsetX+"px",lPx:o.offsetX,top:o.offsetY+"px",tPx:o.offsetY,width:0,wPx:0,height:0,hPx:0};else if("workarea"==o.target.id){var r=l.offset(),n=o.pageX-r.left,i=o.pageY-r.top,s=t.screen.wPx,d=t.screen.hPx,c=n>0?n:0;c=Math.floor(c>s?s:c);var f=i>0?i:0;f=Math.floor(f>d?d:f),a.initPos={lPx:c,tPx:f},a.areaStyle={left:c+"px",lPx:c,top:f+"px",tPx:f,width:0,wPx:0,height:0,hPx:0}}else"drawAreaBox"==o.target.id&&(t.tools.drawArea.isMoving=!0)})},mouseup:function(e){e.scope.data.tools.drawArea.isMoving=!1,e.scope.data.tools.drawArea.finishSelect(e)},mouseleave:function(){},finishSelect:function(e){var t=e.event,a=e.scope.data,o=a.tools.drawArea;o.isMoving||1==t.buttons||(o.config.leftPx=o.config.areaStyle.lPx,o.config.topPx=o.config.areaStyle.tPx)},mouseenter:function(e){e.scope.data.tools.drawArea.finishSelect(e)},mousemove:function(e,t){var a=$("#canvas");1==e.buttons&&t.$apply(function(){var o=t.data,l=o.tools.drawArea.config;if(console.log(t.data.tools.drawArea.isMoving),t.data.tools.drawArea.isMoving){var r=l.areaStyle.lPx+e.originalEvent.movementX,n=l.areaStyle.tPx+e.originalEvent.movementY,i=o.screen.wPx,s=o.screen.hPx;r=r>=0?r:0,n=n>=0?n:0,r=r+l.areaStyle.wPx>i?l.areaStyle.lPx:r,n=n+l.areaStyle.hPx>s?l.areaStyle.tPx:n,l.areaStyle.lPx=r,l.areaStyle.left=r+"px",l.areaStyle.tPx=n,l.areaStyle.top=n+"px"}else{var d=a.offset(),c=e.pageX-d.left,f=e.pageY-d.top,p=o.screen.wPx,x=o.screen.hPx,g=c>0?c:0,v=f>0?f:0;g=Math.floor(g>p?p:g),v=Math.floor(v>x?x:v);var u=l.areaStyle.lPx<g?l.areaStyle.lPx:g,y=l.areaStyle.tPx<v?l.areaStyle.tPx:v,w=l.areaStyle.lPx<g?g-l.areaStyle.lPx:l.initPos.lPx-g,m=l.areaStyle.tPx<v?v-l.areaStyle.tPx:l.initPos.tPx-v;l.areaStyle={lPx:u,left:u+"px",tPx:y,top:y+"px",wPx:w,width:w+"px",hPx:m,height:m+"px"}}})}},crop:{isDefault:!1,isActive:!1,id:"crop",launcher:"menu_view",label:"Crop",iconClass:"fa fa-crop",init:function(){console.log("crop init")},destroy:function(){console.log("crop destroy")},mousedown:function(){},mouseup:function(){},mousemove:function(){}},drawBox:{cursor:"crosshair",id:"drawBox",isDefault:!0,isActive:!1,launcher:"toolbar",label:"Draw Box",iconClass:"fa fa-square-o",isMoving:!1,isDrawing:!1,optionsTemplate:'<div id="drawBoxOptions" class="options-panel form-inline"><div class="separator-v margin-right"></div><div class="form-group"><label for="canvasOverflow">Canvas overflow</label><input  type="checkbox" class="margin-no" ng-model="data.screen.overflow" /></div></div>',element:null,config:null,resetConfig:function(e){e.data.tools.drawBox.config={areaClass:"draw-box",areaStyle:$.extend({left:"-10000px",top:"-10000px",width:"0",height:"0",lPx:-1e4,tPx:-1e4,wPx:0,hPx:0},e.data.drawStyle)}},init:function(e,t){t.data.tools.drawBox.resetConfig(t);var a='<div id="drawBoxBox" ng-class="data.tools.drawBox.config.areaClass" ng-style="data.tools.drawBox.config.areaStyle"></div>',o=e(a)(t),l=e(t.data.tools.drawBox.optionsTemplate)(t);$("#canvas").append(o),$("#toolOptions").append(l),t.data.tools.drawBox.element=o,t.data.tools.drawBox.optionsMenu=l},destroy:function(e){var t=e.data.tools.drawBox;t.resetConfig(e),t.element&&(t.element.remove(),t.optionsMenu.remove())},setUndo:function(){},mousedown:function(e){e.scope.data.tools.drawBox.resetConfig(e.scope);var t=e.scope.data,a=t.tools.drawBox.config,o=e.event,l=$("#canvas");e.scope.$apply(function(){if(o.target==l[0])a.areaStyle.left=o.offsetX+"px",a.areaStyle.lPx=o.offsetX,a.areaStyle.top=o.offsetY+"px",a.areaStyle.tPx=o.offsetY,a.initPos={lPx:o.offsetX,tPx:o.offsetY},a.areaStyle.width=0,a.areaStyle.wPx=0,a.areaStyle.height=0,a.areaStyle.hPx=0,t.tools.drawBox.isDrawing=!0;else if("workarea"==o.target.id){var e=l.offset(),r=o.pageX-e.left,n=o.pageY-e.top;console.log(r);var i=t.screen.wPx,s=t.screen.hPx,d=t.screen.overflow?r:r>0?r:0;d=Math.floor(d>i?i:d);var c=t.screen.overflow?n:n>0?n:0;c=Math.floor(c>s?s:c),a.areaStyle.left=d+"px",a.areaStyle.lPx=d,a.areaStyle.top=c+"px",a.areaStyle.tPx=c,a.initPos={lPx:d,tPx:c},a.areaStyle.width=0,a.areaStyle.wPx=0,a.areaStyle.height=0,a.areaStyle.hPx=0,t.tools.drawBox.isDrawing=!0}else"drawBoxBox"==o.target.id&&(t.tools.drawBox.isMoving=!0)})},mouseup:function(e){e.scope.data.tools.drawBox.isMoving=!1,e.scope.data.tools.drawBox.finishSelect(e)},mouseleave:function(){},finishSelect:function(e){var t=e.event,a=e.scope.data,o=a.tools.drawBox;if(!o.isMoving&&1!=t.buttons&&o.isDrawing){if(o.config.areaStyle.wPx>0&&o.config.areaStyle.hPx>0){var l=e.scope.data.fn.tree.returnSelected(a.tree.root.children);a.config.allowNestedElements||(l="layer"==l.type?l:e.scope.data.fn.tree.selectParentLayer(e.scope.data.tree.root.children),e.scope.data.fn.tree.toggleSelected({child:l,data:e.scope.data}));{l.style.tPx}plLeft=l.style.lPx,nlTop=o.config.areaStyle.tPx,nlLeft=o.config.areaStyle.lPx,nlOffset=$.calculateOffset(a,l,o.config.areaStyle),l.children.push({id:a.fn.tree.newLayerName({pre:e.scope.data.lang[e.scope.data.lang.act].element,data:e.scope.data}),type:"element",children:[],style:$.extend({position:"absolute",left:nlOffset.left,lPx:nlOffset.lPx,top:nlOffset.top,tPx:nlOffset.tPx,width:o.config.areaStyle.width,wPx:o.config.areaStyle.wPx,height:o.config.areaStyle.height,hPx:o.config.areaStyle.hPx},a.drawStyle)})}o.isDrawing=!1,o.resetConfig(e.scope)}},mouseenter:function(e){e.scope.data.tools.drawBox.finishSelect(e)},mousemove:function(e,t){if(1==e.buttons){var a=$("#canvas"),o=t.data,l=o.tools.drawBox.config,r=a.offset(),n=e.pageX-r.left,i=e.pageY-r.top,s=o.screen.wPx,d=o.screen.hPx,c=o.screen.overflow?n:n>0?n:0,f=o.screen.overflow?i:i>0?i:0;c=Math.floor(o.screen.overflow?c:c>s?s:c),f=Math.floor(o.screen.overflow?f:f>d?d:f);var p=l.areaStyle.lPx<c?l.areaStyle.lPx:c,x=l.areaStyle.tPx<f?l.areaStyle.tPx:f,g=Math.floor(l.areaStyle.lPx<c?c-l.areaStyle.lPx:l.initPos.lPx-c),v=Math.floor(l.areaStyle.tPx<f?f-l.areaStyle.tPx:l.initPos.tPx-f);t.$apply(function(){l.areaStyle.lPx=p,l.areaStyle.left=p+"px",l.areaStyle.tPx=x,l.areaStyle.top=x+"px",l.areaStyle.wPx=g,l.areaStyle.width=g+"px",l.areaStyle.hPx=v,l.areaStyle.height=v+"px"})}}},selection:{cursor:"pointer",id:"selection",isDefault:!1,isActive:!1,launcher:"toolbar",label:"Select Element",iconClass:"fa fa-mouse-pointer",optionsTemplate:'<div id="selectionOptions" class="options-panel form-inline"><div class="form-group"><label for="selectionTop">Top</label><input class="form-control" type="text" id="selectionTop" ng-model="data.tools.selection.element.style.top" x-key-increment /></div><div class="form-group"><label for="selectionHeight">Left</label><input class="form-control" type="text" id="selectionLeft" ng-model="data.tools.selection.element.style.left" x-key-increment /></div><div class="form-group"><label for="selectionWidth">Width</label><input class="form-control" type="text" id="selectionWidth" ng-model="data.tools.selection.element.style.width" x-key-increment /></div><div class="form-group"><label for="selectionHeight">Height</label><input class="form-control" type="text" id="selectionHeight" ng-model="data.tools.selection.element.style.height" x-key-increment /></div><div class="separator-v margin-right"></div><div class="form-group"><label for="canvasOverflow">Canvas overflow</label><input  type="checkbox" class="margin-no" ng-model="data.screen.overflow" /></div></div>',element:null,init:function(e,t){$("#canvas,#guides").hide();var a=e(t.data.tools.selection.optionsTemplate)(t);$("#toolOptions").append(a)},destroy:function(){$("#canvas,#guides").show(),$("#toolOptions").empty()},setUndo:function(){},mousedown:function(e){var t=e.scope,a=e.event,o=(e.compile,t.data.tools.selection);if(o.element=t.data.fn.tree.searchElementById($(a.target).attr("ob-id"),t.data.tree.root.children),o.initPos={lPx:a.offsetX,tPx:a.offsetY},o.element)t.data.fn.tree.toggleSelected({child:o.element,data:t.data});else{var l=t.data.fn.tree.selectParentLayer(t.data.tree.root.children);t.data.fn.tree.toggleSelected({child:l,data:t.data})}},mouseup:function(){},mouseleave:function(){},finishSelect:function(){},mouseenter:function(){},mousemove:function(e,t){var a=t.data,o=a.tools.selection.element;if(o&&"element"==o.type&&1==e.buttons){var l=o.style.lPx,r=o.style.tPx,n=l+e.originalEvent.movementX,i=r+e.originalEvent.movementY,s=a.screen.wPx,d=a.screen.hPx;a.screen.overflow||(n=n>=0?n:0,i=i>=0?i:0,n=n+o.style.wPx>s?l:n,i=i+o.style.hPx>d?r:i),o.style.left=n+"px",o.style.lPx=n,o.style.top=i+"px",o.style.tPx=i}}}};