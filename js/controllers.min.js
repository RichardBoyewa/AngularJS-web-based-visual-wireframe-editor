angular.module("gui.controllers",[]).controller("main",["$scope","data","$compile",function(e,a){e.data=a,"undefined"==typeof e.data.tree.root&&e.data.fn.tree.reset(e.data),e.fn={toggleSidebar:function(){e.data.config.sidebarClass=""===e.data.config.sidebarClass?"collapsed":""},modal:function(){}},e.data.fn.tree.toggleSelected({child:e.data.fn.tree.searchElementById("layer_1",e.data.tree.root.children),data:e.data}),e.modal={showModal:!1,toggleModal:function(){e.modal.showModal=!e.modal.showModal}},e.createNew=function(){e.data.fn.tree.reset(e.data),e.data.flags.storage.canOverwrite=!1,e.data.tree.root.name=e.createNew.newName,e.data.tree.root.id="document__"+e.data.fn.storage.sanitizeName(e.createNew.newName),e.data.screen.width=e.createNew.width,e.data.screen.height=e.createNew.height,e.data.screen.wPx=e.data.fn.pxNum(e.createNew.width),e.data.screen.hPx=e.data.fn.pxNum(e.createNew.height),$("#newDocumentModal").modal("hide"),e.data.fn.tree.toggleSelected({child:e.data.fn.tree.searchElementById("layer_1",e.data.tree.root.children),data:e.data}),e.createNew.newName=e.data.lang[e.data.lang.act].createNewDocument,e.data.menus.main.actions.save.disabled=!0,s=e},e.createNew.newName=e.data.lang[e.data.lang.act].createNewDocument,e.createNew.width="270px",e.createNew.height="440px",e.documents=e.data.fn.storage.getDocumentNames(),e.documents.setDocumentName=function(a){e.data.tree.root.name=a},e.documents.saveAs=function(){console.log("saving as");var a=function(a){for(var t=0;t<e.documents.length;t++)if(a==e.documents[t].name)return!0;return!1},t=$("#saveAsName").val();e.data.tree.root.name=t,e.data.tree.root.id="document__"+e.data.fn.storage.sanitizeName(t),a(t)?confirm(e.data.lang[e.data.lang.act].doYouWantToOverwrite+' "'+t+'"?')&&(e.data.fn.storage.storeDocument(e),e.data.menus.main.actions.save.disabled=!1):(e.data.fn.storage.storeDocument(e),e.data.menus.main.actions.save.disabled=!1,e.documents=e.data.fn.storage.getDocumentNames()),console.log(e.saveDocumentAsForm),e.saveDocumentAsForm.$setPristine(),e.saveDocumentAsForm.$setUntouched(),$("#saveDocumentAsModal").modal("hide")},e.documents.open=function(){var a=e.documents.documentToOpen;if(a){console.log(a);var t=e.data.fn.storage.getDocumentObjectById(e.documents.documentToOpen);console.log(t.screen),console.log(e.data.screen),e.data.fn.tree.reset(e.data),e.data.flags.storage.canOverwrite=!0,e.data.screen=t.screen,e.data.tree=t.tree,e.data.fn.tree.toggleSelected({child:e.data.fn.tree.searchElementById("layer_1",e.data.tree.root.children),data:e.data}),console.log(e),$("#openDocumentModal").modal("hide"),e.data.menus.main.actions.save.disabled=!1,e.documents.documentToOpen=null}},e.documents.documentToOpen=null}]);