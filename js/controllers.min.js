angular.module("gui.controllers",[]).controller("main",["$scope","data","$compile",function(e,a){s=e,e.data=a,"undefined"==typeof e.data.tree.root&&e.data.fn.tree.reset(e.data),e.fn={modal:function(){}},e.data.fn.tree.toggleSelected({child:e.data.fn.tree.searchElementById("layer_1",e.data.tree.root.children),data:e.data}),e.modal={showModal:!1,toggleModal:function(){e.modal.showModal=!e.modal.showModal}},e.createNew=function(){e.data.fn.tree.reset(e.data),e.data.flags.storage.canOverwrite=!1,e.data.tree.root.name=e.createNew.newName,e.data.tree.root.id="document__"+e.data.fn.storage.sanitizeName(e.createNew.newName),e.data.screen.width=e.createNew.width,e.data.screen.height=e.createNew.height,e.data.screen.wPx=e.data.fn.pxNum(e.createNew.width),e.data.screen.hPx=e.data.fn.pxNum(e.createNew.height),$("#newDocumentModal").modal("hide"),e.data.fn.tree.toggleSelected({child:e.data.fn.tree.searchElementById("layer_1",e.data.tree.root.children),data:e.data}),e.createNew.newName=e.data.lang[e.data.lang.act].createNewDocument,e.data.menus.menus.file.actions.save.disabled=!0,e.newDocumentForm.$setPristine(),e.newDocumentForm.$setUntouched()},e.createNew.newName=e.data.lang[e.data.lang.act].createNewDocument,e.createNew.width="270px",e.createNew.height="440px",e.documents={names:e.data.fn.storage.getDocumentNames(),saveAsName:"New Document",openName:null,fn:{setDocumentName:function(a){e.data.tree.root.name=a},saveAs:function(){var a=e,t=a.data,n=a.documents.names,o=function(e){for(var a=0;a<n.length;a++)if(e==n[a].name)return!0;return!1},d=a.documents.saveAsName;t.tree.root.name=d,t.tree.root.id="document__"+t.fn.storage.sanitizeName(d),o(d)?confirm(t.lang[t.lang.act].doYouWantToOverwrite+' "'+d+'"?')&&(t.fn.storage.storeDocument(e),t.menus.menus.file.actions.save.disabled=!1):(t.fn.storage.storeDocument(e),t.menus.menus.file.actions.save.disabled=!1,n=t.fn.storage.getDocumentNames()),$("#saveDocumentAsModal").modal("hide"),a.documents.saveAsName="New Document",a.documents.names=e.data.fn.storage.getDocumentNames()},open:function(){var a=e.documents.openName;a&&e.data.fn.documents.open(e,a,function(){$("#openDocumentModal").modal("hide"),e.data.menus.menus.file.actions.save.disabled=!1,e.documents.openName=null})}}},e.documents.openName=null}]).controller("preview",["$scope","$routeParams","data",function(e,a,t){e.data=t,e.goEdit=function(){window.location.hash="/main/"}}]);